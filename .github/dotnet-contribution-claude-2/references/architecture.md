# æ¶æ§‹è¨­è¨ˆåƒè€ƒæ–‡ä»¶

## æ ¸å¿ƒå°ˆæ¡ˆ

- **JobBank1111.Job.WebAPI**: ä¸»è¦çš„ Web API æ‡‰ç”¨ç¨‹å¼
- **JobBank1111.Infrastructure**: è·¨é ˜åŸŸåŸºç¤è¨­æ–½æœå‹™
- **JobBank1111.Job.DB**: Entity Framework Core è³‡æ–™å­˜å–å±¤
- **JobBank1111.Job.Contract**: å¾ OpenAPI è¦æ ¼è‡ªå‹•ç”¢ç”Ÿçš„ API å®¢æˆ¶ç«¯åˆç´„

## åˆ†å±¤æ¶æ§‹

### åˆ†å±¤æ¨¡å¼ï¼ˆController â†’ Handler â†’ Repositoryï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Controller  â”‚ â† HTTP è«‹æ±‚/å›æ‡‰ã€è·¯ç”±ã€è«‹æ±‚é©—è­‰ã€HTTP ç‹€æ…‹ç¢¼å°æ‡‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Handler    â”‚ â† æ ¸å¿ƒæ¥­å‹™é‚è¼¯ã€æµç¨‹å”èª¿ã€éŒ¯èª¤è™•ç†èˆ‡çµæœå°è£
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Repository  â”‚ â† è³‡æ–™å­˜å–é‚è¼¯ã€EF Core æ“ä½œã€è³‡æ–™åº«æŸ¥è©¢å°è£
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å„å±¤è·è²¬

#### Controller å±¤
- HTTP è«‹æ±‚/å›æ‡‰è™•ç†
- è·¯ç”±å®šç¾©
- è«‹æ±‚é©—è­‰
- HTTP ç‹€æ…‹ç¢¼å°æ‡‰
- Result Pattern å›æ‡‰è½‰æ›

#### Handler å±¤
- æ ¸å¿ƒæ¥­å‹™é‚è¼¯è™•ç†
- æµç¨‹å”èª¿
- éŒ¯èª¤è™•ç†èˆ‡çµæœå°è£
- ä½¿ç”¨ Result Pattern å›å‚³çµæœ

#### Repository å±¤
- è³‡æ–™å­˜å–é‚è¼¯
- EF Core æ“ä½œ
- è³‡æ–™åº«æŸ¥è©¢å°è£
- ä½¿ç”¨ Result Pattern å›å‚³çµæœ

## å°ˆæ¡ˆçµ„ç¹”æ–¹å¼

### æ–¹æ¡ˆ Aï¼šå–®ä¸€å°ˆæ¡ˆçµæ§‹ï¼ˆç•¶å‰æ¡ç”¨ï¼‰

```
JobBank1111.Job.WebAPI/
â”œâ”€â”€ Member/
â”‚   â”œâ”€â”€ MemberController.cs
â”‚   â”œâ”€â”€ MemberHandler.cs
â”‚   â””â”€â”€ MemberRepository.cs
â”œâ”€â”€ Order/
â”‚   â”œâ”€â”€ OrderController.cs
â”‚   â”œâ”€â”€ OrderHandler.cs
â”‚   â””â”€â”€ OrderRepository.cs
â””â”€â”€ ...
```

**é©ç”¨å ´æ™¯**ï¼š
- å°å‹åœ˜éšŠï¼ˆ3 äººä»¥ä¸‹ï¼‰
- å¿«é€Ÿé–‹ç™¼éœ€æ±‚
- å°ˆæ¡ˆè¦æ¨¡è¼ƒå°

**å„ªé»**ï¼š
- âœ… ç·¨è­¯å¿«é€Ÿ
- âœ… éƒ¨ç½²ç°¡å–®
- âœ… é–‹ç™¼æ•ˆç‡é«˜

**ç¼ºé»**ï¼š
- âŒ ç¨‹å¼ç¢¼è€¦åˆåº¦è¼ƒé«˜
- âŒ ä¸é©åˆå¤§å‹åœ˜éšŠå”ä½œ

### æ–¹æ¡ˆ Bï¼šå¤šå°ˆæ¡ˆçµæ§‹

```
JobBank1111.Job.WebAPI/        â† Controller å±¤
JobBank1111.Job.Handlers/      â† Handler å±¤
JobBank1111.Job.Repositories/  â† Repository å±¤
JobBank1111.Job.DB/            â† è³‡æ–™å­˜å–å±¤
JobBank1111.Infrastructure/    â† åŸºç¤è¨­æ–½å±¤
```

**é©ç”¨å ´æ™¯**ï¼š
- å¤§å‹åœ˜éšŠ
- æ˜ç¢ºåˆ†å·¥éœ€æ±‚
- é•·æœŸç¶­è­·å°ˆæ¡ˆ

**å„ªé»**ï¼š
- âœ… è·è²¬æ¸…æ™°åˆ†é›¢
- âœ… ä¾¿æ–¼åœ˜éšŠå”ä½œ
- âœ… æ˜“æ–¼æ¸¬è©¦

**ç¼ºé»**ï¼š
- âŒ å°ˆæ¡ˆçµæ§‹è¼ƒè¤‡é›œ
- âŒ ç·¨è­¯æ™‚é–“è¼ƒé•·

## æŠ€è¡“å †ç–Š

### æ ¸å¿ƒæ¡†æ¶
- **ASP.NET Core**: 8.0
- **Entity Framework Core**: æœ€æ–°ç‰ˆæœ¬
- **.NET**: 8.0

### è³‡æ–™åº«èˆ‡å¿«å–
- **è³‡æ–™åº«**: SQL Serverï¼ˆæ”¯æ´ Code First èˆ‡ Database Firstï¼‰
- **å¿«å–**: Redis + è¨˜æ†¶é«”å…§å¿«å–å‚™æ´

### éŒ¯èª¤è™•ç†èˆ‡é©—è­‰
- **Result Pattern**: CSharpFunctionalExtensions 3.1.0
- **é©—è­‰**: FluentValidation 11.10.0

### æ¸¬è©¦
- **å–®å…ƒæ¸¬è©¦**: xUnit 2.9.2
- **æ•´åˆæ¸¬è©¦**: Testcontainers 3.10.0
- **BDD æ¸¬è©¦**: Reqnroll.xUnit 2.1.1

### æ—¥èªŒèˆ‡æ–‡ä»¶
- **æ—¥èªŒ**: Serilogï¼ˆçµæ§‹åŒ–æ—¥èªŒï¼‰
- **API æ–‡ä»¶**: Swagger/OpenAPI 3.0ã€ReDocã€Scalar

## ç¨‹å¼ç¢¼ç”¢ç”Ÿå·¥ä½œæµç¨‹

### å®Œæ•´æµç¨‹åœ–

```mermaid
graph LR
    A[OpenAPI è¦æ ¼<br/>doc/openapi.yml] --> B[Refitter<br/>ç”¢ç”Ÿ Client]
    A --> C[NSwag<br/>ç”¢ç”Ÿ Server]
    D[è³‡æ–™åº«] --> E[EF Core<br/>åå‘å·¥ç¨‹]

    B --> F[JobBank1111.Job.Contract/<br/>AutoGenerated/]
    C --> G[JobBank1111.Job.WebAPI/<br/>Contract/AutoGenerated/]
    E --> H[JobBank1111.Job.DB/<br/>AutoGenerated/]

    style A fill:#90EE90
    style F fill:#FFB6C1
    style G fill:#87CEEB
    style H fill:#FFFFE0
```

### å·¥ä½œæµç¨‹èªªæ˜

1. **API è¦æ ¼ç¶­è­·**: `doc/openapi.yml`
2. **ç”¢ç”Ÿå®¢æˆ¶ç«¯ç¨‹å¼ç¢¼**: `task codegen-api-client` â†’ `JobBank1111.Job.Contract/AutoGenerated/`
3. **ç”¢ç”Ÿä¼ºæœå™¨ç¨‹å¼ç¢¼**: `task codegen-api-server` â†’ `JobBank1111.Job.WebAPI/Contract/AutoGenerated/`
4. **åå‘å·¥ç¨‹è³‡æ–™åº«**: `task ef-codegen` â†’ `JobBank1111.Job.DB/AutoGenerated/`

### é‡è¦è¦ç¯„

âš ï¸ **æ‰€æœ‰è‡ªå‹•ç”¢ç”Ÿçš„ç¨‹å¼ç¢¼éƒ½æ”¾åœ¨ `AutoGenerated` è³‡æ–™å¤¾ä¸­ï¼Œä¸å¯æ‰‹å‹•ç·¨è¼¯**

## å¯¦ä½œåƒè€ƒ

### Controller ç¯„ä¾‹
ğŸ“ [src/be/JobBank1111.Job.WebAPI/Member/MemberController.cs](../../src/be/JobBank1111.Job.WebAPI/Member/MemberController.cs)

### Handler ç¯„ä¾‹
ğŸ“ [src/be/JobBank1111.Job.WebAPI/Member/MemberHandler.cs](../../src/be/JobBank1111.Job.WebAPI/Member/MemberHandler.cs)

### Repository ç¯„ä¾‹
ğŸ“ [src/be/JobBank1111.Job.WebAPI/Member/MemberRepository.cs](../../src/be/JobBank1111.Job.WebAPI/Member/MemberRepository.cs)

## æ ¸å¿ƒé–‹ç™¼åŸå‰‡

### ä¸å¯è®Šç‰©ä»¶è¨­è¨ˆ
- ä½¿ç”¨ C# `record` é¡å‹å®šç¾©ä¸å¯è®Šç‰©ä»¶
- æ‰€æœ‰å±¬æ€§ä½¿ç”¨ `init` é—œéµå­—
- ç¯„ä¾‹ï¼š`TraceContext`

### æ¶æ§‹å®ˆå‰‡
- âœ… æ¥­å‹™é‚è¼¯å±¤ä¸æ‡‰ç›´æ¥è™•ç† HTTP ç›¸é—œé‚è¼¯
- âœ… è·¨é ˜åŸŸé—œæ³¨é»ï¼ˆèº«åˆ†é©—è­‰ã€æ—¥èªŒã€è¿½è¹¤ï¼‰åœ¨ä¸­ä»‹è»Ÿé«”å±¤è™•ç†
- âœ… ä½¿ç”¨ä¸å¯è®Šç‰©ä»¶å‚³éç‹€æ…‹
- âœ… é€é DI å®¹å™¨æ³¨å…¥ä¾è³´

### ä¾è³´æ³¨å…¥æœ€ä½³å¯¦è¸
- âœ… ä½¿ç”¨ C# 12 ä¸»å»ºæ§‹å‡½å¼æ³¨å…¥ï¼ˆPrimary Constructorï¼‰
- âœ… ä½¿ç”¨ `IDbContextFactory<T>` è€Œéç›´æ¥æ³¨å…¥ `DbContext`
- âœ… é¿å…ç”Ÿå‘½é€±æœŸå•é¡Œ

## å‘½åè¦ç¯„

### æª”æ¡ˆå‘½å
- **Handler**: `{Feature}Handler.cs`
- **Repository**: `{Feature}Repository.cs`
- **Controller**: `{Feature}Controller.cs` æˆ– `{Feature}ControllerImpl.cs`
- **Request DTO**: `{Action}{Feature}Request.cs`
- **Response DTO**: `{Feature}Response.cs`

### ç¯„ä¾‹
```
Member/
â”œâ”€â”€ MemberController.cs          â† Controller å¯¦ä½œ
â”œâ”€â”€ MemberHandler.cs             â† Handler æ¥­å‹™é‚è¼¯
â”œâ”€â”€ MemberRepository.cs          â† Repository è³‡æ–™å­˜å–
â”œâ”€â”€ CreateMemberRequest.cs       â† å»ºç«‹æœƒå“¡è«‹æ±‚ DTO
â”œâ”€â”€ UpdateMemberRequest.cs       â† æ›´æ–°æœƒå“¡è«‹æ±‚ DTO
â””â”€â”€ MemberResponse.cs            â† æœƒå“¡å›æ‡‰ DTO
```

## åƒè€ƒè³‡æº

- ğŸ“š [CLAUDE.md](../../../CLAUDE.md) - å®Œæ•´å°ˆæ¡ˆæŒ‡å°æ–‡ä»¶
- ğŸ“ [Repository Pattern è¨­è¨ˆ](./repository-pattern.md) - Repository è¨­è¨ˆç­–ç•¥
- ğŸ“ [éŒ¯èª¤è™•ç†](./error-handling.md) - Result Pattern èˆ‡éŒ¯èª¤è™•ç†
- ğŸ“ [ä¸­ä»‹è»Ÿé«”](./middleware.md) - ä¸­ä»‹è»Ÿé«”æ¶æ§‹è¨­è¨ˆ
